# v1.2.23 å¿«é€Ÿå‚è€ƒ (Quick Reference)

## ğŸ¯ ä¸‰å¤§æ ¸å¿ƒæ”¹è¿›

### 1ï¸âƒ£ Advanced æ—¥å¿— - çœ‹ ItemClass
å¯ç”¨ "Advanced" æ—¥å¿—çº§åˆ«ï¼Œæœç´¢ `[EWS] ItemFields` è¡Œï¼š

```
[EWS] ItemFields: PyType=<class '...'> ClassName=CalendarItem ItemClass=IPM.Appointment Type=Single UID=... RecurringMasterId=None IsRecurring=False HasRecurrence=False
```

**å…³é”®çœ‹ç‚¹**ï¼š
- `ItemClass=IPM.Appointment` âœ… æ ‡å‡†é¡¹ï¼ŒType åº”è¯¥æœ‰å€¼
- `ItemClass=IPM.Schedule.Meeting.Request` âš ï¸ éæ ‡å‡†é¡¹ï¼ŒType ä¸º None â†’ é æ¨æ–­
- `HasRecurrence=True` â†’ è¯´æ˜æœ‰é€’å½’æ•°æ®å¯ç”¨

### 2ï¸âƒ£ Type æ¨æ–­ - å¦‚æœ Type=None å°±æ¨æ–­
```
recurrence æœ‰å€¼           â†’ RecurringMaster
recurring_master_id æœ‰å€¼   â†’ Occurrence
is_recurring == False      â†’ Single
å…¶ä»–                      â†’ Unknown
```

å¦‚æœæ¨æ–­å‡º Typeï¼Œä¼šåœ¨æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
```
Type inferred (not from calendar_item_type): Occurrence
```

### 3ï¸âƒ£ Scope è¿‡æ»¤ - æ¨æ–­ç”¨äºè¿‡æ»¤
- "Single" scopeï¼šåªä¿ç•™ Type=Single çš„é¡¹
- "Series" scopeï¼šä¿ç•™ Type=RecurringMaster æˆ– Occurrence çš„é¡¹
- "All" scopeï¼šä¿ç•™æ‰€æœ‰é¡¹

---

## ğŸ” è°ƒè¯•æ­¥éª¤

### å¦‚æœ Type ä»ä¸º Unknown
1. å¯ç”¨ Advanced æ—¥å¿— â†’ æ‰¾ `[EWS] ItemFields` è¡Œ
2. æ£€æŸ¥ `ItemClass` å€¼ï¼š
   - å¦‚æœæ˜¯éæ ‡å‡†ç±»ï¼ˆå¦‚ IPM.Schedule.Meeting.Requestï¼‰
   - æ£€æŸ¥æ˜¯å¦å­˜åœ¨ `recurrence` æˆ– `recurring_master_id`
   - æ£€æŸ¥ `is_recurring` å€¼
3. è‹¥éƒ½ä¸º None/Falseï¼Œè¯¥é¡¹ç¡®å®æ˜¯ Single

### å¦‚æœ RecurrencePattern ä¸ºç©º
1. å¯ç”¨ Advanced æ—¥å¿— â†’ æ‰¾ `[EWS] ItemFields` è¡Œ
2. å¦‚æœ `HasRecurrence=False` ä¸” Type=Single â†’ æ­£å¸¸
3. å¦‚æœ `HasRecurrence=True` ä½† RecurrencePattern ä»ç©º â†’ æ£€æŸ¥æ—¥å¿—ä¸­çš„ä¸»é¡¹æŸ¥è¯¢é”™è¯¯
4. æœç´¢ "é€šè¿‡ RecurringMasterId è·å–ä¸»é¡¹" æˆ– "UID æŸ¥æ‰¾ä¸»é¡¹" çš„é”™è¯¯ä¿¡æ¯

---

## ğŸ“ å…³é”®æ—¥å¿—è¡Œ

æœç´¢è¿™äº›å…³é”®æ—¥å¿—è¡Œä»¥ç†è§£æ‰§è¡Œæµç¨‹ï¼š

| æ—¥å¿—å†…å®¹ | å«ä¹‰ |
|---------|------|
| `[EWS] ItemFields: ...` | é¡¹å®Œæ•´è¯Šæ–­ä¿¡æ¯ |
| `Type inferred (not from calendar_item_type):` | ä½¿ç”¨æ¨æ–­çš„ Type |
| `é€šè¿‡ RecurringMasterId è·å–ä¸»é¡¹` | æ­£åœ¨æŸ¥è¯¢ä¸»é¡¹ |
| `RecurringMasterId ç¼ºå¤±ï¼Œå°è¯•ç”¨ UID æŸ¥æ‰¾` | Fallback UID æŸ¥æ‰¾ |
| `<Trace Tag="EwsResponse"` | EWS æœåŠ¡ç«¯åŸå§‹å“åº” XML |

---

## ğŸ“‹ å¸¸è§æƒ…å†µè§£é‡Š

### æƒ…å†µ 1: Type=Single, RecurrencePattern=ç©º
âœ… **æ­£å¸¸** - è¿™æ˜¯ä¸€ä¸ªä¸é‡å¤çš„ä¼šè®®é¡¹

### æƒ…å†µ 2: Type=Occurrence, RecurrencePattern=æœ‰å€¼
âœ… **æ­£å¸¸** - è¿™æ˜¯ä¸€ä¸ªé‡å¤ä¼šè®®çš„æŸä¸€å®ä¾‹ï¼Œå·²æ‰¾åˆ°ä¸»é¡¹çš„é€’å½’è§„åˆ™

### æƒ…å†µ 3: Type=Unknown, RecurrencePattern=ç©º
âš ï¸ **éœ€æ£€æŸ¥**ï¼š
- ItemClass æ˜¯å¦ä¸ºéæ ‡å‡†ç±»?
- recurrence / recurring_master_id / is_recurring éƒ½ä¸ºç©ºæˆ– False?
- å¦‚æœéƒ½æ˜¯ï¼Œåˆ™ç¡®å®æ˜¯ Unknown

### æƒ…å†µ 4: Type=Unknown, RecurrencePattern=æœ‰å€¼
âš ï¸ **éœ€æ£€æŸ¥**ï¼š
- æ˜¯å¦ç”¨ UID fallback æ‰¾åˆ°äº†ä¸»é¡¹?
- æ£€æŸ¥ "é€šè¿‡ UID æŸ¥æ‰¾ä¸»é¡¹" ç›¸å…³æ—¥å¿—

### æƒ…å†µ 5: ItemClass=IPM.Schedule.Meeting.Request, Type=None
âš ï¸ **é¢„æœŸè¡Œä¸º**ï¼š
- è¿™ä¸æ˜¯æ ‡å‡† IPM.Appointment
- calendar_item_type ä¸º None æ˜¯æ­£å¸¸çš„
- Type åº”è¯¥é€šè¿‡æ¨æ–­å¾—å‡ºï¼ˆå¦‚æœ recurring_master_id æœ‰å€¼ â†’ Occurrenceï¼‰

---

## ğŸ› ï¸ æ”¹å˜ç‰ˆæœ¬æ­¥éª¤

å¦‚éœ€ä¸‹ä¸€ç‰ˆæœ¬ä¿®å¤ï¼Œæ ¹æ®æ—¥å¿—åé¦ˆï¼š

1. **æ”¶é›†æ—¥å¿—**ï¼š`%USERPROFILE%\Documents\UniversalEmailCleaner\app.log`
2. **åˆ†äº«å…³é”®è¡Œ**ï¼š`[EWS] ItemFields` + å¯¹åº”çš„ `<Trace Tag="EwsResponse">`
3. **æè¿°é—®é¢˜**ï¼šType/RecurrencePattern æœŸæœ›å€¼ vs å®é™…å€¼
4. **ç­‰å¾…ä¿®å¤**ï¼šæ ¹æ®è¯Šæ–­ä¿¡æ¯æ”¹è¿›ä»£ç æˆ–é…ç½®

---

## ğŸ“¦ æ–‡ä»¶ä½ç½®

- **å¯æ‰§è¡Œæ–‡ä»¶**: `Q:\Dev\Python\TestEnv1\Projects\Python\UniversalEmailCleaner\dist\UniversalEmailCleaner_v1.2.23.exe`
- **æ—¥å¿—æ–‡ä»¶**: `%USERPROFILE%\Documents\UniversalEmailCleaner\app.log`
- **æŠ¥å‘Š**: `%USERPROFILE%\Documents\UniversalEmailCleaner\Reports\`
- **è¯¦ç»†æ–‡æ¡£**: åŒç›®å½•ä¸‹ `v1.2.23_DIAGNOSTIC_IMPROVEMENTS.md`

